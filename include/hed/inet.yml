schema: lib
name: inet
version: 0.0.1
doc: inet structure
prefix: hed_

headers:
  - <hed/priv/config.h>
  - <sys/socket.h>

declarations:
  -
    name: ether_addr
    type: custom
    header: <netinet/ether.h>
    struct: struct ether_addr
    min: DPACK_BIN_SIZE(ETH_ALEN)
    max: DPACK_BIN_SIZE(ETH_ALEN)
    encode: hed_encode_ether_addr
    decode: hed_decode_ether_addr
    check: hed_check_ether_addr
  -
    name: in_addr
    type: custom
    header: <netinet/in.h>
    struct: struct in_addr
    min: DPACK_UINT_SIZE_MIN
    max: DPACK_UINT_SIZE_MAX
    encode: hed_encode_in_addr
    decode: hed_decode_in_addr
    check: hed_check_in_addr
  -
    name: in6_addr
    type: custom
    header: <netinet/in.h>
    struct: struct in6_addr
    min: DPACK_BIN_SIZE(16)
    max: DPACK_BIN_SIZE(16)
    encode: hed_encode_in6_addr
    decode: hed_decode_in6_addr
    check: hed_check_in6_addr
  -
    name: ip_type
    type: enum
    entries:
      -
        name: IPv4
        value: AF_INET
      -
        name: IPv6
        value: AF_INET6
  -
    name: in_pfx
    type: u8
    max: 32
  -
    name: in6_pfx
    type: u8
    max: 128
  -
    name: port
    type: u16
    min: 1
  -
    name: in_svc
    type: struct
    entries:
      -
        name: addr
        type: $in_addr
      -
        name: port
        type: $port
  -
    name: in6_svc
    type: struct
    entries:
      -
        name: addr
        type: $in6_addr
      -
        name: port
        type: $port
  -
    name: in_net
    type: struct
    check: hed_in_net_check_addr_prefix
    entries:
      -
        name: addr
        type: $in_addr
      -
        name: prefix
        type: $in_pfx
  -
    name: in6_net
    type: struct
    check: hed_in6_net_check_addr_prefix
    entries:
      -
        name: addr
        type: $in6_addr
      -
        name: prefix
        type: $in6_pfx
